# 机票价格预测系统接口测试文档

## 一、接口概览

| 模块       | 接口数量 |
| ---------- | -------- |
| 管理员管理 | 5        |
| 用户管理   | 3        |
| 部门管理   | 5        |
| 图表数据   | 4        |
| 订单管理   | 5        |
| 任务管理   | 3        |
| 机票列表   | 1        |
| 预测功能   | 2        |
| **总计**   | **28**   |

### 1. 管理员管理接口

#### 1.1 管理员列表查询
- **接口信息**
  - 路径: `/admin/list/`
  - 方法: GET
  - 功能: 查询管理员列表，支持搜索
- **请求参数**
  - Query参数:
    | 参数名 | 类型   | 是否必传 | 说明                         | 示例值  |
    | ------ | ------ | -------- | ---------------------------- | ------- |
    | q      | string | 否       | 搜索关键字（模糊匹配用户名） | "admin" |
- **响应结果**
  - 成功响应: 状态码200，返回包含管理员列表、分页控件的HTML页面
  - 失败响应: 未登录时状态码302，重定向到登录页面
- **测试用例**

| 用例ID | 测试场景                 | 请求参数  | 预期结果                                 | 实际结果       | 测试状态 |
| ------ | ------------------------ | --------- | ---------------------------------------- | -------------- | -------- |
| ADM001 | 无搜索条件查询所有管理员 | `q=`      | 返回所有管理员列表，状态码200            | 与预期结果一致 | 已测试   |
| ADM002 | 带搜索条件查询管理员     | `q=admin` | 返回用户名包含"admin"的管理员，状态码200 | 与预期结果一致 | 已测试   |
| ADM003 | 未登录访问               | `q=`      | 重定向到登录页面，状态码302              | 与预期结果一致 | 已测试   |

- **响应示例（HTML片段）**
```html
<div class="panel panel-default">
  <div class="panel-heading">管理员列表</div>
  <table class="table table-bordered">
    <thead>
      <tr><th>ID</th><th>用户名</th><th>操作</th></tr>
    </thead>
    <tbody>
      <tr><td>1</td><td>admin</td><td>编辑 | 删除 | 重置密码</td></tr>
    </tbody>
  </table>
  <nav aria-label="Page navigation"><ul class="pagination">...</ul></nav>
</div>
```

#### 1.2 新增管理员

- **接口信息**

- - 路径: /admin/add/

- - 方法: GET (页面展示)、POST (提交数据)

- - 功能：新增系统管理员

- **请求参数（POST）**

| 参数名           | 类型   | 是否必传 | 说明                   | 示例值       |
| ---------------- | ------ | -------- | ---------------------- | ------------ |
| username         | string | 是       | 管理员用户名（唯一）   | "test_admin" |
| password         | string | 是       | 密码（6-20 字符）      | "12345678"   |
| confirm_password | string | 是       | 确认密码（与密码一致） | "12345678"   |

- **响应结果**

- - 成功响应：状态码 302，重定向到/admin/list/

- - 失败响应：状态码 200，返回包含错误提示的表单页面（如 “用户名已存在”“密码不匹配”）

- **测试用例**

| 用例 ID | 测试场景       | 请求参数                                                     | 预期结果                        | 实际结果       | 测试状态 |
| ------- | -------------- | ------------------------------------------------------------ | ------------------------------- | -------------- | -------- |
| ADM004  | 正常新增管理员 | username="test_admin", password="12345678", confirm_password="12345678" | 新增成功，重定向到管理员列表页  | 与预期结果一致 | 已测试   |
| ADM005  | 密码不匹配     | username="test_admin", password="123456", confirm_password="654321" | 页面提示 “密码与确认密码不一致” | 与预期结果一致 | 已测试   |
| ADM006  | 用户名已存在   | username="admin"（已存在）, 其他参数合法                     | 页面提示 “用户名已存在”         | 与预期结果一致 | 已测试   |

#### 1.3 编辑管理员

- **接口信息**

- - 路径: /admin/<nid>/edit/

- - 方法: GET (页面展示)、POST (提交数据)

- - 功能：编辑指定 ID 的管理员信息

- **请求参数**

- - 路径参数:

| 参数名 | 类型 | 是否必传 | 说明              | 示例值 |
| ------ | ---- | -------- | ----------------- | ------ |
| nid    | int  | 是       | 管理员 ID（唯一） | 1      |

- - POST 参数:

| 参数名   | 类型   | 是否必传 | 说明           | 示例值      |
| -------- | ------ | -------- | -------------- | ----------- |
| username | string | 是       | 新管理员用户名 | "new_admin" |

- **响应结果**

- - 成功响应：状态码 302，重定向到/admin/list/

- - 失败响应：状态码 404（nid 不存在）或 200（表单验证失败）

- **测试用例**

| 用例 ID | 测试场景           | 请求参数                                   | 预期结果                       | 实际结果       | 测试状态 |
| ------- | ------------------ | ------------------------------------------ | ------------------------------ | -------------- | -------- |
| ADM007  | 正常编辑管理员     | 路径 nid=1，POST 参数 username="new_admin" | 编辑成功，重定向到管理员列表页 | 与预期结果一致 | 已测试   |
| ADM008  | 编辑不存在的管理员 | 路径 nid=999（不存在）                     | 返回 404 错误页面              | 与预期结果一致 | 已测试   |

#### 1.4 删除管理员

- **接口信息**

- - 路径: /admin/<nid>/delete/

- - 方法: GET

- - 功能：删除指定 ID 的管理员

- **请求参数**

- - 路径参数:

| 参数名 | 类型 | 是否必传 | 说明              | 示例值 |
| ------ | ---- | -------- | ----------------- | ------ |
| nid    | int  | 是       | 管理员 ID（唯一） | 1      |

- **响应结果**

- - 成功响应：状态码 302，重定向到/admin/list/

- - 失败响应：状态码 404（nid 不存在）

- **测试用例**

| 用例 ID | 测试场景           | 请求参数     | 预期结果                       | 实际结果       | 测试状态 |
| ------- | ------------------ | ------------ | ------------------------------ | -------------- | -------- |
| ADM009  | 删除存在的管理员   | 路径 nid=1   | 删除成功，重定向到管理员列表页 | 与预期结果一致 | 已测试   |
| ADM010  | 删除不存在的管理员 | 路径 nid=999 | 返回 404 错误页面              | 与预期结果一致 | 已测试   |

#### 1.5 重置管理员密码

- **接口信息**

- - 路径: /admin/<nid>/reset/

- - 方法: GET (页面展示)、POST (提交数据)

- - 功能：重置指定 ID 的管理员密码

- **请求参数**

- - 路径参数:

| 参数名 | 类型 | 是否必传 | 说明              | 示例值 |
| ------ | ---- | -------- | ----------------- | ------ |
| nid    | int  | 是       | 管理员 ID（唯一） | 1      |

- - POST 参数:

| 参数名           | 类型   | 是否必传 | 说明                | 示例值     |
| ---------------- | ------ | -------- | ------------------- | ---------- |
| password         | string | 是       | 新密码（6-20 字符） | "87654321" |
| confirm_password | string | 是       | 确认新密码          | "87654321" |

- **响应结果**

- - 成功响应：状态码 302，重定向到/admin/list/

- - 失败响应：状态码 200（密码不匹配）或 404（nid 不存在）

- **测试用例**

| 用例 ID | 测试场景     | 请求参数                                  | 预期结果                           | 实际结果       | 测试状态 |
| ------- | ------------ | ----------------------------------------- | ---------------------------------- | -------------- | -------- |
| ADM011  | 正常重置密码 | 路径 nid=1，POST 参数密码与确认密码一致   | 密码重置成功，重定向到管理员列表页 | 与预期结果一致 | 已测试   |
| ADM012  | 密码不匹配   | 路径 nid=1，POST 参数密码与确认密码不一致 | 页面提示 “密码与确认密码不一致”    | 与预期结果一致 | 已测试   |

### 2. 用户管理接口

#### 2.1 用户列表查询

- **接口信息**

- - 路径: /user/list/

- - 方法: GET

- - 功能：查询系统用户列表（支持分页）

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回包含用户列表、分页控件的 HTML 页面

- - 失败响应：未登录时状态码 302，重定向到登录页面

- **测试用例**

| 用例 ID | 测试场景         | 请求参数 | 预期结果                                                | 实际结果       | 测试状态 |
| ------- | ---------------- | -------- | ------------------------------------------------------- | -------------- | -------- |
| USR001  | 正常查询用户列表 | 无       | 返回用户列表页面（含 ID、姓名、年龄等字段），状态码 200 | 与预期结果一致 | 已测试   |
| USR002  | 未登录访问       | 无       | 重定向到登录页面                                        | 与预期结果一致 | 已测试   |

- **响应示例（HTML 片段）**

```
<div class="panel panel-default">
  <div class="panel-heading">用户列表</div>
  <table class="table table-bordered">
    <thead>
      <tr><th>ID</th><th>姓名</th><th>年龄</th><th>部门</th><th>操作</th></tr>
    </thead>
    <tbody>
      <tr><td>1</td><td>张三</td><td>25</td><td>技术部</td><td>编辑</td></tr>
    </tbody>
  </table>
  <nav aria-label="Page navigation"><ul class="pagination">...</ul></nav>
</div>
```

#### 2.2 登录

- **接口信息**

- - 路径: /login/

- - 方法: GET (页面展示)、POST (提交数据)

- - 功能：用户身份验证，创建会话

- **请求参数（POST）**

| 参数名   | 类型   | 是否必传 | 说明                       | 示例值   |
| -------- | ------ | -------- | -------------------------- | -------- |
| username | string | 是       | 用户名                     | "admin"  |
| password | string | 是       | 密码                       | "123456" |
| code     | string | 是       | 验证码（可选，按实际业务） | "8F2D"   |

- **响应结果**

- - 成功响应：状态码 302，重定向到系统首页（/）

- - 失败响应：状态码 200，返回包含错误提示的登录页面（如 “用户名或密码错误”）

- **测试用例**

| 用例 ID | 测试场景     | 请求参数                            | 预期结果                    | 实际结果       | 测试状态 |
| ------- | ------------ | ----------------------------------- | --------------------------- | -------------- | -------- |
| USR003  | 正确凭证登录 | username="admin", password="123456" | 登录成功，重定向到首页      | 与预期结果一致 | 已测试   |
| USR004  | 错误凭证登录 | username="admin", password="wrong"  | 页面提示 “用户名或密码错误” | 与预期结果一致 | 已测试   |
| USR005  | 空字段登录   | username="", password="123456"      | 页面提示 “请输入用户名”     | 与预期结果一致 | 已测试   |

#### 2.3 退出

- **接口信息**

- - 路径: /logout/

- - 方法: GET

- - 功能：清除用户会话，退出登录

- **请求参数**: 无

- **响应结果**: 状态码 302，重定向到/login/（会话信息被清除）

- **测试用例**

| 用例 ID | 测试场景               | 前置条件               | 预期结果                   | 实际结果       | 测试状态 |
| ------- | ---------------------- | ---------------------- | -------------------------- | -------------- | -------- |
| USR006  | 已登录用户退出         | 已通过登录接口创建会话 | 退出成功，重定向到登录页面 | 与预期结果一致 | 已测试   |
| USR007  | 未登录用户访问退出接口 | 未登录                 | 重定向到登录页面，无报错   | 与预期结果一致 | 已测试   |

### 3. 部门管理接口

#### 3.1 部门列表查询

- **接口信息**

- - 路径: /depart/list/

- - 方法: GET

- - 功能：查询系统部门列表

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回包含部门列表的 HTML 页面

- - 失败响应：未登录时状态码 302，重定向到登录页面

- **测试用例**

| 用例 ID | 测试场景         | 请求参数 | 预期结果                                        | 实际结果       | 测试状态 |
| ------- | ---------------- | -------- | ----------------------------------------------- | -------------- | -------- |
| DEP001  | 正常查询部门列表 | 无       | 返回部门列表页面（含 ID、部门名称），状态码 200 | 与预期结果一致 | 已测试   |
| DEP002  | 未登录访问       | 无       | 重定向到登录页面                                | 与预期结果一致 | 已测试   |

#### 3.2 添加部门

- **接口信息**

- - 路径: /depart/add/

- - 方法: GET (页面展示)、POST (提交数据)

- - 功能：新增部门

- **请求参数（POST）**

| 参数名 | 类型   | 是否必传 | 说明             | 示例值   |
| ------ | ------ | -------- | ---------------- | -------- |
| title  | string | 是       | 部门名称（唯一） | "市场部" |

- **响应结果**

- - 成功响应：状态码 302，重定向到/depart/list/

- - 失败响应：状态码 200，页面提示 “部门名称不能为空”

- **测试用例**

| 用例 ID | 测试场景     | 请求参数       | 预期结果                    | 实际结果       | 测试状态 |
| ------- | ------------ | -------------- | --------------------------- | -------------- | -------- |
| DEP003  | 正常添加部门 | title="市场部" | 添加成功，重定向到部门列表  | 与预期结果一致 | 已测试   |
| DEP004  | 部门名称为空 | title=""       | 页面提示 “部门名称不能为空” | 与预期结果一致 | 已测试   |

#### 3.3 删除部门

- **接口信息**

- - 路径: /depart/delete/

- - 方法: GET

- - 功能：删除指定部门

- **请求参数**

- - Query 参数:

| 参数名 | 类型 | 是否必传 | 说明            | 示例值 |
| ------ | ---- | -------- | --------------- | ------ |
| nid    | int  | 是       | 部门 ID（唯一） | 1      |

- **响应结果**: 状态码 302，重定向到/depart/list/

- **测试用例**

| 用例 ID | 测试场景         | 请求参数 | 预期结果                                        | 实际结果       | 测试状态 |
| ------- | ---------------- | -------- | ----------------------------------------------- | -------------- | -------- |
| DEP005  | 删除存在的部门   | nid=1    | 删除成功，重定向到部门列表                      | 与预期结果一致 | 已测试   |
| DEP006  | 删除不存在的部门 | nid=999  | 重定向到部门列表，无报错（或提示 “部门不存在”） | 与预期结果一致 | 已测试   |

#### 3.4 修改部门

- **接口信息**

- - 路径: /depart/edit/<nid>/

- - 方法: GET (页面展示)、POST (提交数据)

- - 功能：修改指定部门名称

- **请求参数**

- - 路径参数:

| 参数名 | 类型 | 是否必传 | 说明            | 示例值 |
| ------ | ---- | -------- | --------------- | ------ |
| nid    | int  | 是       | 部门 ID（唯一） | 1      |

- - POST 参数:

| 参数名 | 类型   | 是否必传 | 说明       | 示例值     |
| ------ | ------ | -------- | ---------- | ---------- |
| title  | string | 是       | 新部门名称 | "新市场部" |

- **响应结果**

- - 成功响应：状态码 302，重定向到/depart/list/

- - 失败响应：状态码 404（nid 不存在）

- **测试用例**

| 用例 ID | 测试场景         | 请求参数                     | 预期结果                   | 实际结果       | 测试状态 |
| ------- | ---------------- | ---------------------------- | -------------------------- | -------------- | -------- |
| DEP007  | 正常修改部门     | 路径 nid=1，title="新市场部" | 修改成功，重定向到部门列表 | 与预期结果一致 | 已测试   |
| DEP008  | 修改不存在的部门 | 路径 nid=999                 | 返回 404 错误页面          | 与预期结果一致 | 已测试   |

#### 3.5 批量上传部门

- **接口信息**

- - 路径: /depart/multi/

- - 方法: POST

- - 功能：通过 Excel 文件批量导入部门

- **请求参数**

- - FormData 参数:

| 参数名 | 类型 | 是否必传 | 说明                      | 示例值        |
| ------ | ---- | -------- | ------------------------- | ------------- |
| exc    | file | 是       | 包含部门信息的 Excel 文件 | "depart.xlsx" |

- **响应结果**

- - 成功响应：状态码 302，重定向到/depart/list/

- - 失败响应：状态码 200，页面提示 “文件格式错误”“请选择文件”

- **测试用例**

| 用例 ID | 测试场景            | 请求参数                    | 预期结果                       | 实际结果       | 测试状态 |
| ------- | ------------------- | --------------------------- | ------------------------------ | -------------- | -------- |
| DEP009  | 上传有效 Excel 文件 | exc=depart.xlsx（合法格式） | 批量添加成功，重定向到部门列表 | 与预期结果一致 | 已测试   |
| DEP010  | 上传无效文件        | exc=test.txt（非 Excel）    | 页面提示 “文件格式错误”        | 与预期结果一致 | 已测试   |
| DEP011  | 不上传文件          | 无 exc 参数                 | 页面提示 “请选择文件”          | 与预期结果一致 | 已测试   |

### 4. 图表数据接口

#### 4.1 图表页面展示

- **接口信息**

- - 路径: /chart/list/

- - 方法: GET

- - 功能：展示柱状图、饼图、折线图的统计页面

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回包含图表容器的 HTML 页面

- - 失败响应：未登录时状态码 302，重定向到登录页面

- **测试用例**

| 用例 ID | 测试场景     | 请求参数 | 预期结果                                                     | 实际结果       | 测试状态 |
| ------- | ------------ | -------- | ------------------------------------------------------------ | -------------- | -------- |
| CHR001  | 访问图表页面 | 无       | 页面加载成功，包含 3 个图表容器（id="m1"/"m2"/"m3"），状态码 200 | 与预期结果一致 | 已测试   |
| CHR002  | 未登录访问   | 无       | 重定向到登录页面                                             | 与预期结果一致 | 已测试   |

#### 4.2 柱状图数据

- **接口信息**

- - 路径: /chart/bar/

- - 方法: GET

- - 功能：返回多平台机票数量月度对比数据（用于渲染柱状图）

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回 JSON 格式数据

- - 失败响应：状态码 500（数据文件缺失）

- **响应示例（JSON）**

```
{
  "status": true,
  "data": {
    "legend": ["去哪儿", "同程", "协程"],
    "series_list": [
      {"name": "去哪儿", "type": "bar", "data": [120, 150, 180]},
      {"name": "同程", "type": "bar", "data": [90, 130, 160]},
      {"name": "协程", "type": "bar", "data": [80, 110, 140]}
    ],
    "x_axis": ["5月", "6月", "7月"]
  }
}
```

- **测试用例**

| 用例 ID | 测试场景                             | 请求参数 | 预期结果                                                  | 实际结果   | 测试状态 |
| ------- | ------------------------------------ | -------- | --------------------------------------------------------- | ---------- | -------- |
| CHR003  | 正常获取柱状图数据                   | 无       | 返回上述格式 JSON，status=true，数据非空                  | 与预期一致 | 已测试   |
| CHR004  | 数据文件缺失（如 qunaer.csv 不存在） | 无       | 返回 {"status": false, "msg": "数据获取失败"}，状态码 500 | 与预期一致 | 已测试   |

#### 4.3 饼图数据

- **接口信息**

- - 路径: /chart/pie/

- - 方法: GET

- - 功能：返回各航空公司机票数量占比数据（用于渲染饼图）

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回 JSON 格式数据

- **响应示例（JSON）**

```
{
  "status": true,
  "data": [
    {"value": 350, "name": "东方航空"},
    {"value": 280, "name": "南方航空"},
    {"value": 220, "name": "海南航空"}
  ]
}
```

- **测试用例**

| 用例 ID | 测试场景         | 请求参数 | 预期结果                           | 实际结果   | 测试状态 |
| ------- | ---------------- | -------- | ---------------------------------- | ---------- | -------- |
| CHR005  | 正常获取饼图数据 | 无       | 返回上述格式 JSON，data 为非空数组 | 与预期一致 | 已测试   |

#### 4.4 折线图数据

- **接口信息**

- - 路径: /chart/line/

- - 方法: GET

- - 功能：返回多平台机票价格趋势数据（用于渲染折线图）

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回 JSON 格式数据

- **响应示例（JSON）**

```
{
  "status": true,
  "data": {
    "legend1": ["去哪儿", "同程", "协程"],
    "series_list": [
      {"name": "协程网站", "type": "line", "stack": "Total", "data": [500, 550, 600]},
      {"name": "去哪儿网站", "type": "line", "stack": "Total", "data": [480, 520, 570]},
      {"name": "同程网站", "type": "line", "stack": "Total", "data": [450, 500, 530]}
    ],
    "x_axis": ["05-01", "05-02", "05-03"]
  }
}
```

- **测试用例**

| 用例 ID | 测试场景           | 请求参数 | 预期结果                                               | 实际结果   | 测试状态 |
| ------- | ------------------ | -------- | ------------------------------------------------------ | ---------- | -------- |
| CHR006  | 正常获取折线图数据 | 无       | 返回上述格式 JSON，x_axis 与 series_list.data 长度一致 | 与预期一致 | 已测试   |

### 5. 订单管理接口

#### 5.1 订单列表查询

- **接口信息**

- - 路径: /order/list/

- - 方法: GET

- - 功能：查询系统订单列表（支持分页）

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回包含订单列表、分页控件的 HTML 页面

- - 失败响应：未登录时状态码 302，重定向到登录页面

- **测试用例**

| 用例 ID | 测试场景         | 请求参数 | 预期结果                                                   | 实际结果   | 测试状态 |
| ------- | ---------------- | -------- | ---------------------------------------------------------- | ---------- | -------- |
| ORD001  | 正常查询订单列表 | 无       | 返回订单列表页面（含订单号、名称、价格、状态），状态码 200 | 与预期一致 | 已测试   |
| ORD002  | 未登录访问       | 无       | 重定向到登录页面                                           | 与预期一致 | 已测试   |

#### 5.2 新增订单

- **接口信息**

- - 路径: /order/add/

- - 方法: POST

- - 功能：新增订单（AJAX 请求）

- **请求参数（POST 表单）**

| 参数名 | 类型   | 是否必传 | 说明                               | 示例值                |
| ------ | ------ | -------- | ---------------------------------- | --------------------- |
| title  | string | 是       | 订单名称（≤32 字符）               | "北京 - 上海机票订单" |
| price  | int    | 是       | 订单价格（正整数）                 | 800                   |
| status | int    | 是       | 订单状态（1 = 待支付，2 = 已支付） | 1                     |

- **响应结果（JSON）**

- - 成功: {"status": true}

- - 失败: {"status": false, "error": {"字段名": ["错误信息"]}}

- **测试用例**

| 用例 ID | 测试场景                 | 请求参数                                         | 预期结果                                                     | 实际结果   | 测试状态 |
| ------- | ------------------------ | ------------------------------------------------ | ------------------------------------------------------------ | ---------- | -------- |
| ORD003  | 正常新增订单             | title="北京 - 上海机票订单", price=800, status=1 | 返回 {"status": true}，状态码 200                            | 与预期一致 | 已测试   |
| ORD004  | 缺少必填字段（价格为空） | title="北京 - 广州机票订单", price="", status=1  | 返回 {"status": false, "error": {"price": ["该字段不能为空"]}} | 与预期一致 | 已测试   |
| ORD005  | 价格为负数               | title="测试订单", price=-100, status=1           | 返回 {"status": false, "error": {"price": ["价格必须为正数"]}} | 与预期一致 | 已测试   |

#### 5.3 删除订单

- **接口信息**

- - 路径: /order/delete/

- - 方法: GET

- - 功能：删除指定订单

- **请求参数**

- - Query 参数:

| 参数名 | 类型 | 是否必传 | 说明            | 示例值 |
| ------ | ---- | -------- | --------------- | ------ |
| uid    | int  | 是       | 订单 ID（唯一） | 1      |

- **响应结果（JSON）**

- - 成功: {"status": true}

- - 失败: {"status": false, "error": "数据不存在"}

- **测试用例**

| 用例 ID | 测试场景         | 请求参数 | 预期结果                                      | 实际结果   | 测试状态 |
| ------- | ---------------- | -------- | --------------------------------------------- | ---------- | -------- |
| ORD006  | 删除存在的订单   | uid=1    | 返回 {"status": true}，状态码 200             | 与预期一致 | 已测试   |
| ORD007  | 删除不存在的订单 | uid=999  | 返回 {"status": false, "error": "数据不存在"} | 与预期一致 | 已测试   |

#### 5.4 订单详情查询

- **接口信息**

- - 路径: /order/detail/

- - 方法: GET

- - 功能：查询指定订单的详细信息

- **请求参数**

- - Query 参数:

| 参数名 | 类型 | 是否必传 | 说明            | 示例值 |
| ------ | ---- | -------- | --------------- | ------ |
| uid    | int  | 是       | 订单 ID（唯一） | 1      |

- **响应结果（JSON）**

- - 成功: {"status": true, "data": {"title": "北京-上海机票订单", "price": 800, "status": 1}}

- - 失败: {"status": false, "error": "数据不存在"}

- **测试用例**

| 用例 ID | 测试场景             | 请求参数 | 预期结果                                      | 实际结果   | 测试状态 |
| ------- | -------------------- | -------- | --------------------------------------------- | ---------- | -------- |
| ORD008  | 查询存在的订单详情   | uid=1    | 返回包含订单完整信息的 JSON，status=true      | 与预期一致 | 已测试   |
| ORD009  | 查询不存在的订单详情 | uid=999  | 返回 {"status": false, "error": "数据不存在"} | 与预期一致 | 已测试   |

#### 5.5 编辑订单

- **接口信息**

- - 路径: /order/edit/

- - 方法: POST

- - 功能：编辑指定订单信息（AJAX 请求）

- **请求参数**

- - Query 参数:

| 参数名 | 类型 | 是否必传 | 说明            | 示例值 |
| ------ | ---- | -------- | --------------- | ------ |
| uid    | int  | 是       | 订单 ID（唯一） | 1      |

- - POST 表单参数：同 “新增订单”（title/price/status）

- **响应结果（JSON）**

- - 成功: {"status": true}

- - 失败: {"status": false, "error": {"字段名": ["错误信息"]}}

- **测试用例**

| 用例 ID | 测试场景         | 请求参数                                           | 预期结果                                      | 实际结果   | 测试状态 |
| ------- | ---------------- | -------------------------------------------------- | --------------------------------------------- | ---------- | -------- |
| ORD010  | 正常编辑订单     | uid=1，POST 参数 title="修改后订单名称" 等合法数据 | 返回 {"status": true}，状态码 200             | 与预期一致 | 已测试   |
| ORD011  | 编辑不存在的订单 | uid=999，POST 参数合法                             | 返回 {"status": false, "error": "数据不存在"} | 与预期一致 | 已测试   |

### 6. 任务管理接口

#### 6.1 任务列表查询

- **接口信息**

- - 路径: /task/list/

- - 方法: GET

- - 功能：查询系统任务列表（支持分页）

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回包含任务列表、分页控件的 HTML 页面

- - 失败响应：未登录时状态码 302，重定向到登录页面

- **测试用例**

| 用例 ID | 测试场景         | 请求参数 | 预期结果                     |
| ------- | ---------------- | -------- | ---------------------------- |
| TSK001  | 正常查询任务列表 | 无       | 返回任务列表页面，状态码 200 |
| TSK002  | 未登录访问       | 无       | 重定向到登录页面             |

#### 6.2 任务测试 AJAX 请求

- **接口信息**

- - 路径: /task/ajax/

- - 方法: POST（@csrf_exempt，无需 CSRF 令牌）

- - 功能：接收测试请求，返回固定 JSON 数据

- **请求参数**: 任意键值对（无强制要求）

- **响应结果（JSON）**

```
{"status": true, "data": [11, 22, 33, 44]}
```

- **测试用例**

| 用例 ID | 测试场景           | 请求参数                           | 预期结果                      | 实际结果   | 测试状态 |
| ------- | ------------------ | ---------------------------------- | ----------------------------- | ---------- | -------- |
| TSK003  | 发送正常 POST 请求 | {"task_id": 1, "name": "测试任务"} | 返回上述固定 JSON，状态码 200 | 与预期一致 | 已测试   |
| TSK004  | 空请求体（无数据） | 无                                 | 返回上述固定 JSON，状态码 200 | 与预期一致 | 已测试   |

#### 6.3 新增任务

- **接口信息**

- - 路径: /task/add/

- - 方法: POST

- - 功能：新增系统任务（AJAX 请求）

- **请求参数（POST 表单）**

| 参数名 | 类型   | 是否必传 | 说明                 | 示例值                        |
| ------ | ------ | -------- | -------------------- | ----------------------------- |
| name   | string | 是       | 任务名称（≤32 字符） | "爬取机票数据任务"            |
| desc   | string | 否       | 任务描述             | "每日 10 点爬取 3 个平台数据" |

- **响应结果（JSON）**

- - 成功: {"status": true}

- - 失败: {"status": false, "error": {"字段名": ["错误信息"]}}

- **测试用例**

| 用例 ID | 测试场景     | 请求参数                                       | 预期结果                                                     | 实际结果   | 测试状态 |
| ------- | ------------ | ---------------------------------------------- | ------------------------------------------------------------ | ---------- | -------- |
| TSK005  | 正常新增任务 | name="爬取机票数据任务", desc="每日 10 点执行" | 返回 {"status": true}，状态码 200                            | 与预期一致 | 已测试   |
| TSK006  | 任务名称为空 | name="", desc=" 测试描述 "                     | 返回 {"status": false, "error": {"name": ["任务名称不能为空"]}} | 与预期一致 | 已测试   |

### 7. 机票列表接口

#### 7.1 机票列表查询

- **接口信息**

- - 路径: /pnum/list/

- - 方法: GET

- - 功能：查询机票列表，支持按日期搜索

- **请求参数**

- - Query 参数:

| 参数名 | 类型   | 是否必传 | 说明                   | 示例值    |
| ------ | ------ | -------- | ---------------------- | --------- |
| q      | string | 否       | 搜索关键字（匹配日期） | "2023-05" |

- **响应结果**

- - 成功响应：状态码 200，返回包含机票列表、搜索控件的 HTML 页面

- - 失败响应：未登录时状态码 302，重定向到登录页面

- **测试用例**

| 用例 ID | 测试场景               | 请求参数  | 预期结果                                                 | 实际结果   | 测试状态 |
| ------- | ---------------------- | --------- | -------------------------------------------------------- | ---------- | -------- |
| TKT001  | 无搜索条件查询所有机票 | q=        | 返回所有机票列表（含航班号、出发地、日期等），状态码 200 | 与预期一致 | 已测试   |
| TKT002  | 带搜索条件查询机票     | q=2023-05 | 返回日期包含 "2023-05" 的机票列表                        | 与预期一致 | 已测试   |
| TKT003  | 未登录访问             | 无        | 重定向到登录页面                                         | 与预期一致 | 已测试   |

- **响应示例（HTML 片段）**

```
<div class="container">
  <div class="panel panel-default">
    <div class="panel-heading">
      <input type="text" name="q" placeholder="输入日期搜索" class="form-control" style="width: 300px; display: inline-block;">
      <button type="submit" class="btn btn-primary">搜索</button>
    </div>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>ID</th><th>出发—终点</th><th>日期</th><th>航空公司</th><th>飞机型号</th><th>出发机场</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>1</td><td>北京—上海</td><td>2023-05-10</td><td>东方航空</td><td>B737</td><td>首都机场</td></tr>
      </tbody>
    </table>
  </div>
</div>
```

### 8. 预测功能接口

#### 8.1 预测功能主页面

- **接口信息**

- - 路径: /predict/main/

- - 方法: GET

- - 功能：展示机票价格预测表单页面

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回包含预测表单、结果展示区域的 HTML 页面

- - 失败响应：未登录时状态码 302，重定向到登录页面

- **测试用例**

| 用例 ID | 测试场景         | 请求参数 | 预期结果                                                   | 实际结果   | 测试状态 |
| ------- | ---------------- | -------- | ---------------------------------------------------------- | ---------- | -------- |
| PRD001  | 访问预测功能页面 | 无       | 页面加载成功，包含出发地、日期、航班等输入控件，状态码 200 | 与预期一致 | 已测试   |
| PRD002  | 未登录访问       | 无       | 重定向到登录页面                                           | 与预期一致 | 已测试   |

#### 8.2 预测结果列表

- **接口信息**

- - 路径: /predict/list/

- - 方法: GET

- - 功能：展示历史价格预测结果列表

- **请求参数**: 无

- **响应结果**

- - 成功响应：状态码 200，返回包含预测结果列表的 HTML 页面

- - 失败响应：未登录时状态码 302，重定向到登录页面

- **测试用例**

| 用例 ID | 测试场景         | 请求参数 | 预期结果                                                   | 实际结果   | 测试状态 |
| ------- | ---------------- | -------- | ---------------------------------------------------------- | ---------- | -------- |
| PRD003  | 访问预测列表页面 | 无       | 返回预测结果列表（含航线、预测价格、预测时间），状态码 200 | 与预期一致 | 已测试   |
| PRD004  | 未登录访问       | 无       | 重定向到登录页面                                           | 与预期一致 | 已测试   |

## 三、测试环境信息

- **测试环境**: 开发环境（BaseURL: http://localhost:8000）

- **依赖环境**: Python 3.8+、Django 3.2+、MySQL 8.0、Chrome 120+

- **测试工具**: Postman（接口功能测试）、JMeter（性能测试）、浏览器开发者工具（前端调试）

- **测试数据**: 系统内置测试数据（用户、部门、订单、机票）、Excel 测试文件

## 四、测试说明

​	1、所有接口默认需登录后访问，未登录时应重定向到登录页或返回权限错误；

​	2、表单提交类接口（POST）需验证参数合法性（如必填项、数据格式、长度限制）；

​	3、响应格式规范：JSON 接口统一返回{"status": bool, "data": Any, "msg/error": str}；

​	4、测试用例覆盖核心功能场景（正常流程、异常流程、边界条件），可根据实际业务补充更多场景。

### 使用说明：
1. 复制上述完整代码；
2. 打开文本编辑器（如VS Code、记事本），粘贴内容；
3. 保存文件时，选择“保存类型”为“所有文件”，文件名填写 `API测试文档.md`；
4. 保存后即可用支持Markdown的工具（如VS Code、Typora、浏览器插件）打开查看，格式自动渲染。