import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import GaussianNB
from sklearn.metrics import accuracy_score, classification_report
# 使用一个内置的示例数据集
from sklearn.datasets import load_iris

# 1. 准备数据
print("1. 正在加载和准备数据...")
iris = load_iris()
X = iris.data  # 特征数据 (Features)
y = iris.target  # 标签/目标 (Labels)

# 将数据分成训练集和测试集
# test_size=0.3 表示 30% 的数据用于测试
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

# 2. 初始化模型
print("2. 正在初始化 Gaussian Naive Bayes 模型...")
# GaussianNB 适用于特征是连续值的情况（如 Iris 数据集）
model = GaussianNB()

# 3. 训练模型
print("3. 正在训练模型...")
model.fit(X_train, y_train)

# 4. 做出预测
print("4. 正在使用测试集进行预测...")
y_pred = model.predict(X_test)

# 5. 模型评估
print("\n--- 5. 模型评估结果 ---")
# 计算准确率 (Accuracy)
accuracy = accuracy_score(y_test, y_pred)
print(f"模型的准确率 (Accuracy): {accuracy:.4f}")

# 打印详细的分类报告 (Classification Report)
print("\n分类报告 (Classification Report):")
print(classification_report(y_test, y_pred, target_names=iris.target_names))

# 6. 示例：用新数据进行预测
print("\n--- 6. 新数据预测示例 ---")
# 假设有一个新的样本，特征值如下
new_data = np.array([[5.1, 3.5, 1.4, 0.2]]) # 这是一个鸢尾花样本的特征
prediction = model.predict(new_data)
predicted_class_name = iris.target_names[prediction[0]]
print(f"新的样本数据: {new_data}")
print(f"预测的类别索引
